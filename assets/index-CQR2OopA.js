import{r,u as ve,j as e,C as Oe,S as $e,O as Be,R as ye,H as _e,c as he}from"./three-vendor-CsKYoJpk.js";import"./react-vendor-DJG_os-6.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function s(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(o){if(o.ep)return;o.ep=!0;const d=s(o);fetch(o.href,d)}})();function De({lane:t,laneX:n,lanes:s,invincible:i}){const o=r.useRef(),[d,p]=r.useState(0),x=r.useRef(new Map).current;r.useEffect(()=>{o.current&&o.current.traverse(w=>{w.isMesh&&w.material&&(x.has(w.uuid)||x.set(w.uuid,w.material.opacity),w.material.transparent=!0)})},[x]),ve((w,Z)=>{if(o.current)if(i){p(L=>L+Z*16);const F=.4+.6*Math.abs(Math.sin(Date.now()/80));o.current.traverse(L=>{L.isMesh&&L.material&&(L.material.opacity=F)}),o.current.rotation.z=.15*Math.sin(d)}else p(0),o.current.traverse(F=>{if(F.isMesh&&F.material){const L=x.get(F.uuid);F.material.opacity=typeof L=="number"?L:1}}),o.current.rotation.z=0});const M="#D32F2F",v="#B71C1C",h="#AABBC3",c="#1A1A1A",g="#B0BEC5",u="#546E7A",z="#FFFDE7",j="#EF5350",D="#78909C",C=.3,f=.95,b=.35,y=2.1,G={color:M,metalness:.4,roughness:.3},R={color:v,metalness:.3,roughness:.4},O={color:h,transparent:!0,opacity:.5,roughness:.1},E={color:c,roughness:.8},U={color:g,metalness:.9,roughness:.25},N={color:u,metalness:.7,roughness:.5},P={color:z,emissive:z,emissiveIntensity:.6},J={color:j,emissive:j,emissiveIntensity:.5};return e.jsxs("group",{ref:o,position:[n(t),C,0],children:[e.jsxs("mesh",{position:[0,.18,.65],children:[e.jsx("boxGeometry",{args:[f*.9,b*.85,y*.4]}),e.jsx("meshStandardMaterial",{...G})]}),e.jsxs("mesh",{position:[0,.2,0],children:[e.jsx("boxGeometry",{args:[f,b,y*.5]}),e.jsx("meshStandardMaterial",{...G})]}),e.jsxs("mesh",{position:[0,.22,-.75],children:[e.jsx("boxGeometry",{args:[f*.95,b*.9,y*.3]}),e.jsx("meshStandardMaterial",{...G})]}),e.jsxs("mesh",{position:[0,b+.02+.175,-.15],children:[" ",e.jsx("boxGeometry",{args:[f*.75,.35,.8]})," ",e.jsx("meshStandardMaterial",{...G})]}),e.jsxs("mesh",{position:[0,b+.25,.2],rotation:[-Math.PI/6.5,0,0],children:[e.jsx("boxGeometry",{args:[f*.7,.02,.45]}),e.jsx("meshStandardMaterial",{...O})]}),e.jsxs("mesh",{position:[0,b+.25,-.48],rotation:[Math.PI/7,0,0],children:[e.jsx("boxGeometry",{args:[f*.65,.02,.35]}),e.jsx("meshStandardMaterial",{...O})]}),e.jsxs("mesh",{position:[-f*.37,b+.2,-.15],rotation:[0,Math.PI/22,0],children:[e.jsx("boxGeometry",{args:[.02,.3,.33]}),e.jsx("meshStandardMaterial",{...O})]}),e.jsxs("mesh",{position:[f*.37,b+.2,-.15],rotation:[0,-Math.PI/22,0],children:[e.jsx("boxGeometry",{args:[.02,.3,.33]}),e.jsx("meshStandardMaterial",{...O})]}),[{x:-f/2+.05,z:y/2*.7,name:"FL"},{x:f/2-.05,z:y/2*.7,name:"FR"},{x:-f/2+.05,z:-y/2*.75,name:"RL"},{x:f/2-.05,z:-y/2*.75,name:"RR"}].map(w=>e.jsxs("group",{position:[w.x,0,w.z],children:[e.jsxs("mesh",{rotation:[0,0,Math.PI/2],children:[e.jsx("cylinderGeometry",{args:[C,C,.18,24]}),e.jsx("meshStandardMaterial",{...E})]}),e.jsxs("mesh",{rotation:[0,0,Math.PI/2],children:[e.jsx("cylinderGeometry",{args:[C*.75,C*.7,.2,20]}),e.jsx("meshStandardMaterial",{...U})]}),e.jsxs("mesh",{rotation:[0,0,Math.PI/2],position:[0,w.name.startsWith("F")?.015:-.015,0],children:[" ",e.jsx("cylinderGeometry",{args:[C*.55,C*.55,.03,16]}),e.jsx("meshStandardMaterial",{...N})]})]},w.name)),e.jsxs("mesh",{position:[0,b+.05,-y/2+.05],children:[e.jsx("boxGeometry",{args:[f*.9,.06,.25]}),e.jsx("meshStandardMaterial",{...R})]}),e.jsxs("mesh",{position:[-.3,b+.02,-y/2+.05],children:[e.jsx("boxGeometry",{args:[.05,.04,.05]}),e.jsx("meshStandardMaterial",{...R})]}),e.jsxs("mesh",{position:[.3,b+.02,-y/2+.05],children:[e.jsx("boxGeometry",{args:[.05,.04,.05]}),e.jsx("meshStandardMaterial",{...R})]}),e.jsxs("mesh",{position:[-f*.3,.2,y/2-.02],rotation:[0,-Math.PI/32,0],children:[e.jsx("boxGeometry",{args:[.15,.1,.04]}),e.jsx("meshStandardMaterial",{...P})]}),e.jsxs("mesh",{position:[f*.3,.2,y/2-.02],rotation:[0,Math.PI/32,0],children:[e.jsx("boxGeometry",{args:[.15,.1,.04]}),e.jsx("meshStandardMaterial",{...P})]}),e.jsxs("mesh",{position:[-f*.3,.25,-y/2+.01],children:[e.jsx("boxGeometry",{args:[.3,.08,.03]}),e.jsx("meshStandardMaterial",{...J})]}),e.jsxs("mesh",{position:[f*.3,.25,-y/2+.01],children:[e.jsx("boxGeometry",{args:[.3,.08,.03]}),e.jsx("meshStandardMaterial",{...J})]}),e.jsxs("mesh",{position:[-f/2-.01,b+.1,.1],children:[e.jsx("boxGeometry",{args:[.03,.08,.12]}),e.jsx("meshStandardMaterial",{...R})]}),e.jsxs("mesh",{position:[f/2+.01,b+.1,.1],children:[e.jsx("boxGeometry",{args:[.03,.08,.12]}),e.jsx("meshStandardMaterial",{...R})]}),e.jsxs("mesh",{position:[-f*.25,.05,-y/2-.01],rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.05,.05,.1,12]}),e.jsx("meshStandardMaterial",{color:D,metalness:.8,roughness:.3})]}),e.jsxs("mesh",{position:[f*.25,.05,-y/2-.01],rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.05,.05,.1,12]}),e.jsx("meshStandardMaterial",{color:D,metalness:.8,roughness:.3})]})]})}function Ne({lane:t,laneX:n,z:s,colorIndex:i=0}){const o=["#2c3e50","#e74c3c","#3498db","#27ae60","#f39c12"],d=o[i%o.length],p=d==="#f39c12"?"#e67e22":d;return e.jsxs("group",{position:[n(t),-.4,s],children:[e.jsxs("mesh",{position:[0,.4,0],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.4,.6,2.2]}),e.jsx("meshStandardMaterial",{color:d,metalness:.2,roughness:.6})]}),e.jsxs("mesh",{position:[0,.9,-.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.2,.5,1.4]}),e.jsx("meshStandardMaterial",{color:p,metalness:.1,roughness:.7})]}),e.jsxs("mesh",{position:[0,.25,1.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.3,.3,.2]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[0,.25,-1.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.3,.3,.2]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[.5,.35,1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.25,.15,.1]}),e.jsx("meshStandardMaterial",{color:"#f8f9fa",emissive:"#ffffff",emissiveIntensity:.1})]}),e.jsxs("mesh",{position:[-.5,.35,1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.25,.15,.1]}),e.jsx("meshStandardMaterial",{color:"#f8f9fa",emissive:"#ffffff",emissiveIntensity:.1})]}),e.jsxs("mesh",{position:[.5,.35,-1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.2,.12,.1]}),e.jsx("meshStandardMaterial",{color:"#dc3545",emissive:"#ff0000",emissiveIntensity:.05})]}),e.jsxs("mesh",{position:[-.5,.35,-1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.2,.12,.1]}),e.jsx("meshStandardMaterial",{color:"#dc3545",emissive:"#ff0000",emissiveIntensity:.05})]}),e.jsxs("mesh",{position:[0,.85,.4],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.1,.4,.05]}),e.jsx("meshStandardMaterial",{color:"#17a2b8",transparent:!0,opacity:.6})]}),e.jsxs("mesh",{position:[0,.85,-.8],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.1,.35,.05]}),e.jsx("meshStandardMaterial",{color:"#17a2b8",transparent:!0,opacity:.6})]}),e.jsxs("mesh",{position:[.75,.75,.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.08,.06,.12]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[-.75,.75,.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.08,.06,.12]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[-.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[-.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[-.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[-.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[0,.25,1.32],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.3,.08,.02]}),e.jsx("meshStandardMaterial",{color:"#ffffff"})]}),e.jsxs("mesh",{position:[.4,.08,-1.35],rotation:[0,Math.PI/2,0],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.04,.04,.1,8]}),e.jsx("meshStandardMaterial",{color:"#666666",metalness:.8,roughness:.3})]}),e.jsxs("mesh",{position:[.82,.15,0],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.04,.1,2]}),e.jsx("meshStandardMaterial",{color:"#c0392b",metalness:.2,roughness:.5})]}),e.jsxs("mesh",{position:[-.82,.15,0],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.04,.1,2]}),e.jsx("meshStandardMaterial",{color:"#c0392b",metalness:.2,roughness:.5})]})]})}const Pe=2e3,me=3,fe=-100,He=2,qe=10,Je="#777",be=5,we=2.4,Ue=we*3,Ye={position:"absolute",top:20,left:20,background:"rgba(0,0,0,0.78)",color:"#fff",fontSize:22,borderRadius:7,padding:"10px 18px",zIndex:10,fontWeight:600},Xe={position:"absolute",top:50,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#000",fontSize:"clamp(24px, 5vw, 48px)",border:"4px solid #ff4141",borderRadius:12,padding:"12px 30px",fontWeight:700,zIndex:10,boxShadow:"0 2px 16px #0002",maxWidth:"90vw",textAlign:"center"},Ke={background:"#fff",color:"#000",fontWeight:700,fontSize:216,borderRadius:8,padding:"6px 18px",border:"2px solid #222",boxShadow:"0 2px 8px #0002",pointerEvents:"none"},le=(t="Floris")=>parseInt(localStorage.getItem(`tafelRaceHighScore_${t}`)||"0"),Qe=(t,n="Floris")=>{localStorage.setItem(`tafelRaceHighScore_${n}`,t.toString())},ae=(t="Floris")=>{const n=localStorage.getItem(`tafelRaceIncorrectAnswers_${t}`);return n?JSON.parse(n):[]},Ve=(t,n,s,i="Floris")=>{const o=ae(i),d={question:t,correctAnswer:n,givenAnswer:s,timestamp:Date.now(),id:Math.random().toString(36).slice(2)};o.unshift(d),o.length>10&&o.splice(10),localStorage.setItem(`tafelRaceIncorrectAnswers_${i}`,JSON.stringify(o))},q=(t="Floris")=>{const n=localStorage.getItem(`tafelRacePendingRepeats_${t}`);return n?JSON.parse(n):[]},Ze=(t,n,s="Floris")=>{const i=q(s),o={question:t,correctAnswer:n,addedAt:Date.now(),id:Math.random().toString(36).slice(2)};i.push(o),localStorage.setItem(`tafelRacePendingRepeats_${s}`,JSON.stringify(i))},et=(t,n="Floris")=>{const i=q(n).filter(o=>o.id!==t);localStorage.setItem(`tafelRacePendingRepeats_${n}`,JSON.stringify(i))},Me=(t="Floris")=>{const n=localStorage.getItem(`tafelRaceStatistics_${t}`);return n?JSON.parse(n):{}},ge=(t,n,s="Floris")=>{const i=Me(s);i[t]||(i[t]={attempts:0,mistakes:0}),i[t].attempts++,n||i[t].mistakes++,localStorage.setItem(`tafelRaceStatistics_${s}`,JSON.stringify(i))},tt=(t="Floris")=>{localStorage.removeItem(`tafelRaceStatistics_${t}`),localStorage.removeItem(`tafelRaceIncorrectAnswers_${t}`),localStorage.removeItem(`tafelRacePendingRepeats_${t}`)};function ze(t,n=0,s=[]){if(s.length>0&&n>0&&n%be===0){const x=s[0],M=x.correctAnswer;let v=[M];const h=x.question.split(" × ");if(h.length===2){const c=parseInt(h[0]);for(;v.length<t;){let g=c*(Math.floor(Math.random()*10)+1);v.includes(g)||v.push(g)}}else for(;v.length<t;){let c=Math.floor(Math.random()*100)+1;v.includes(c)||v.push(c)}for(let c=v.length-1;c>0;c--){const g=Math.floor(Math.random()*(c+1));[v[c],v[g]]=[v[g],v[c]]}return[x.question,M,v,x.id]}const i=Math.floor(Math.random()*10)+1,o=Math.floor(Math.random()*10)+1,d=i*o;let p=[d];for(;p.length<t;){let x=i*(Math.floor(Math.random()*10)+1);p.includes(x)||p.push(x)}for(let x=p.length-1;x>0;x--){const M=Math.floor(Math.random()*(x+1));[p[x],p[M]]=[p[M],p[x]]}return[`${i} × ${o}`,d,p,null]}function ue(){const[t,n]=r.useState("init"),[s,i]=r.useState("Floris"),[o,d]=r.useState(()=>window.innerWidth<window.innerHeight?4:6),[p,x]=r.useState(150),[M,v]=r.useState(0),[h,c]=r.useState(0),[g,u]=r.useState(le("Floris")),[z,j]=r.useState(3),[D,C]=r.useState(null),[f,b]=r.useState(null),[y,G]=r.useState(null),[R,O]=r.useState(0),[E,U]=r.useState(0),[N,P]=r.useState([]),[J,w]=r.useState([]),[Z,F]=r.useState(!1),[L,ce]=r.useState(0),[Y,te]=r.useState(me),[K,A]=r.useState(!1),[se,oe]=r.useState(0),[ne,B]=r.useState(!1),[m,l]=r.useState(!1),[W,k]=r.useState(ae("Floris")),[T,S]=r.useState(q("Floris")),[$,I]=r.useState(!1),[Q,V]=r.useState(!1),[X,Ie]=r.useState(!1),[de,Re]=r.useState({question:"",answer:""}),ke=p/1e3*(m?4:1),Ae=fe,Ce=M*1e3,pe=r.useCallback(()=>{c(0),j(3),U(0),w([]),P([]),A(!1),te(me),O(0),n("countdown"),S(q(s))},[s]),Ge=r.useCallback(()=>{n("init"),A(!1)},[]),Ee=r.useCallback(a=>{c(a);const _=le(s);a>_&&(u(a),Qe(a,s))},[s]),re=r.useCallback(a=>{i(a),u(le(a)),k(ae(a)),S(q(a))},[]),Te=r.useCallback(()=>{n("statistics")},[]);r.useEffect(()=>{if(t!=="countdown")return;if(Y===0){n("play");const[_,H,ee,Fe]=ze(o,R,q(s));C(_),b(H),G(Fe),P(ee.map((Le,We)=>({lane:We,z:fe,value:Le,id:Math.random().toString(36).slice(2),questionId:Date.now().toString()})));return}const a=setTimeout(()=>te(_=>_-1),1e3);return()=>clearTimeout(a)},[t,Y,o,R,s]),r.useEffect(()=>{if(t!=="play")return;const a=H=>{H.key==="ArrowLeft"&&U(ee=>Math.max(ee-1,0)),H.key==="ArrowRight"&&U(ee=>Math.min(ee+1,o-1)),H.key==="ArrowUp"&&l(!0)},_=H=>{H.key==="ArrowUp"&&l(!1)};return window.addEventListener("keydown",a),window.addEventListener("keyup",_),()=>{window.removeEventListener("keydown",a),window.removeEventListener("keyup",_)}},[t,o]);const ie=a=>(a-(o-1)/2)*2.5,xe=r.useCallback(a=>{t==="play"&&U(a)},[t]);return e.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",background:"#7ecbff"},children:[$&&e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(255, 0, 0, 0.6)",zIndex:50,pointerEvents:"none"}}),Q&&e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 255, 0, 0.4)",zIndex:50,pointerEvents:"none"}}),X&&e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.8)",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:60,pointerEvents:"none"},children:[e.jsx("div",{style:{fontSize:60,fontWeight:700,marginBottom:20},children:de.question}),e.jsxs("div",{style:{fontSize:80,fontWeight:900,color:"#4CAF50"},children:["= ",de.answer]})]}),e.jsxs("div",{style:{...Ye,fontSize:"clamp(14px, 3vw, 22px)",padding:"8px 16px"},children:["Speler: ",s,"  |  Score: ",h,"  |  Lives: ",z,e.jsx("br",{}),"High Score: ",g]}),t==="play"&&D&&N.length>0&&e.jsx("div",{style:Xe,children:D}),t==="play"&&N.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",bottom:"clamp(100px, 16vh, 140px)",left:"50%",transform:"translateX(-50%)",background:"rgba(0, 0, 0, 0.8)",color:"#fff",fontSize:"clamp(18px, 4vw, 32px)",fontWeight:"700",padding:"8px 16px",borderRadius:8,zIndex:15,textAlign:"center",border:"2px solid #ff4141"},children:D}),e.jsx("div",{style:{position:"absolute",bottom:"clamp(20px, 4vh, 40px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"clamp(4px, 1vw, 8px)",zIndex:15,padding:"8px",background:"rgba(0, 0, 0, 0.3)",borderRadius:12,backdropFilter:"blur(5px)",maxWidth:"95vw",overflowX:"auto"},children:N.map((a,_)=>e.jsx("button",{onClick:()=>xe(a.lane),onTouchStart:H=>{H.preventDefault(),xe(a.lane)},style:{width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",borderRadius:"10px",border:E===a.lane?"3px solid #ff4141":"2px solid #fff",background:E===a.lane?"#ff4141":"rgba(255, 255, 255, 0.9)",color:E===a.lane?"#fff":"#000",fontSize:"clamp(14px, 3vw, 20px)",fontWeight:"900",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",userSelect:"none",touchAction:"manipulation",boxShadow:E===a.lane?"0 3px 10px rgba(255, 65, 65, 0.4)":"0 2px 6px rgba(0, 0, 0, 0.2)",transform:E===a.lane?"scale(1.05)":"scale(1)",flexShrink:0},children:a.value},a.id))})]}),t==="play"&&e.jsx("div",{style:{position:"absolute",bottom:"clamp(80px, 12vh, 120px)",right:"clamp(15px, 3vw, 25px)",zIndex:15},children:e.jsxs("button",{onTouchStart:a=>{a.preventDefault(),l(!0)},onTouchEnd:a=>{a.preventDefault(),l(!1)},onMouseDown:()=>l(!0),onMouseUp:()=>l(!1),onMouseLeave:()=>l(!1),style:{width:"clamp(60px, 12vw, 80px)",height:"clamp(60px, 12vw, 80px)",borderRadius:"50%",border:"3px solid #fff",background:m?"linear-gradient(135deg, #ff6b6b, #ee5a52)":"rgba(255, 255, 255, 0.8)",color:m?"#fff":"#000",fontSize:"clamp(12px, 2.5vw, 16px)",fontWeight:"700",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",userSelect:"none",touchAction:"manipulation",boxShadow:m?"0 4px 15px rgba(255, 107, 107, 0.4)":"0 3px 10px rgba(0, 0, 0, 0.2)",transform:m?"scale(1.05)":"scale(1)"},children:[e.jsx("div",{style:{fontSize:"clamp(18px, 4vw, 24px)",marginBottom:"2px"},children:"🚀"}),e.jsx("div",{style:{fontSize:"clamp(8px, 2vw, 12px)"},children:"BOOST"})]})}),t==="countdown"&&e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.6)",color:"#fff",fontSize:90,display:"flex",alignItems:"center",justifyContent:"center",zIndex:20,fontWeight:900},children:Y>0?Y:"GO!"}),K&&e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",color:"#fff",fontSize:48,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:30},children:[e.jsx("div",{style:{marginBottom:30},children:"Game Over"}),e.jsxs("div",{style:{fontSize:32,marginBottom:10},children:["Score: ",h]}),e.jsxs("div",{style:{fontSize:24,marginBottom:30,color:"#ffd700"},children:["High Score: ",g]}),e.jsxs("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{style:{fontSize:28,padding:"12px 40px",borderRadius:10,border:"none",background:"#ff4141",color:"#fff",fontWeight:700,cursor:"pointer",touchAction:"manipulation"},onClick:pe,children:"Opnieuw"}),e.jsx("button",{style:{fontSize:28,padding:"12px 40px",borderRadius:10,border:"none",background:"#666",color:"#fff",fontWeight:700,cursor:"pointer",touchAction:"manipulation"},onClick:Ge,children:"Instellingen"})]})]}),t==="statistics"&&e.jsx(st,{currentPlayer:s,onBack:()=>n("init")}),t==="init"&&e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",color:"#fff",fontSize:"clamp(20px, 4vw, 32px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",zIndex:40,padding:"clamp(10px, 3vw, 20px)",overflowY:"auto"},children:[e.jsx("div",{style:{marginBottom:"clamp(20px, 5vh, 40px)",fontSize:"clamp(24px, 6vw, 40px)"},children:"Tafel Race Game"}),e.jsxs("div",{style:{fontSize:"clamp(18px, 4vw, 28px)",marginBottom:"clamp(15px, 4vh, 30px)",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:15},children:"Kies speler:"}),e.jsxs("div",{style:{display:"flex",gap:"clamp(10px, 3vw, 20px)",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(8px, 2vw, 12px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"3px solid #ff4141",background:s==="Floris"?"#ff4141":"transparent",color:"#fff",fontWeight:700,cursor:"pointer",transition:"all 0.2s ease",touchAction:"manipulation"},onClick:()=>re("Floris"),children:"👦 Floris"}),e.jsx("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(8px, 2vw, 12px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"3px solid #ff4141",background:s==="Esmee"?"#ff4141":"transparent",color:"#fff",fontWeight:700,cursor:"pointer",transition:"all 0.2s ease",touchAction:"manipulation"},onClick:()=>re("Esmee"),children:"👧 Esmee"}),e.jsx("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(8px, 2vw, 12px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"3px solid #ff4141",background:s==="Tim"?"#ff4141":"transparent",color:"#fff",fontWeight:700,cursor:"pointer",transition:"all 0.2s ease",touchAction:"manipulation"},onClick:()=>re("Tim"),children:"👨‍🦳 Tim"})]})]}),e.jsxs("div",{style:{fontSize:"clamp(14px, 3vw, 22px)",marginBottom:"clamp(10px, 2vh, 20px)",textAlign:"center"},children:["Aantal rijstroken: ",o,e.jsx("input",{type:"range",min:He,max:qe,value:o,onChange:a=>d(+a.target.value),style:{marginLeft:12,width:"clamp(100px, 25vw, 150px)"}})]}),e.jsxs("div",{style:{fontSize:"clamp(14px, 3vw, 22px)",marginBottom:"clamp(10px, 2vh, 20px)",textAlign:"center"},children:["Snelheid: ",p,e.jsx("input",{type:"range",min:20,max:200,value:p,onChange:a=>x(+a.target.value),style:{marginLeft:12,width:"clamp(100px, 25vw, 150px)"}})]}),e.jsxs("div",{style:{fontSize:"clamp(14px, 3vw, 22px)",marginBottom:"clamp(15px, 3vh, 30px)",textAlign:"center"},children:["Poorten interval: ",M,"s",e.jsx("input",{type:"range",min:2,max:8,value:M,onChange:a=>v(+a.target.value),style:{marginLeft:12,width:"clamp(100px, 25vw, 150px)"}})]}),e.jsxs("button",{style:{fontSize:"clamp(18px, 4vw, 28px)",padding:"clamp(8px, 2vh, 12px) clamp(20px, 5vw, 40px)",borderRadius:10,border:"none",background:"#ff4141",color:"#fff",fontWeight:700,cursor:"pointer",marginBottom:"clamp(10px, 2vh, 20px)",touchAction:"manipulation"},onClick:pe,children:["Start (",s,")"]}),e.jsxs("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(6px, 1.5vh, 10px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"2px solid #4CAF50",background:"transparent",color:"#4CAF50",fontWeight:700,cursor:"pointer",marginBottom:"clamp(20px, 4vh, 40px)",touchAction:"manipulation"},onClick:Te,children:["📊 Statistieken (",s,")"]}),e.jsxs("div",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",marginBottom:"clamp(15px, 3vh, 30px)",color:"#ffd700",textAlign:"center"},children:["🏆 ",s,"'s High Score: ",g]}),W.length>0&&e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:10,padding:"clamp(10px, 3vw, 20px)",maxWidth:"clamp(300px, 80vw, 600px)",width:"100%"},children:[e.jsxs("h3",{style:{fontSize:"clamp(14px, 3vw, 20px)",marginBottom:15,color:"#ff6b6b",textAlign:"center"},children:[s,"'s Fouten (Laatste 10)"]}),e.jsx("div",{style:{maxHeight:"clamp(200px, 30vh, 300px)",overflowY:"auto",fontSize:"clamp(12px, 2.5vw, 16px)"},children:W.map((a,_)=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",margin:"5px 0",padding:"8px",borderRadius:5,borderLeft:"3px solid #ff6b6b"},children:[e.jsxs("div",{style:{fontWeight:"bold"},children:[a.question," = ",a.correctAnswer]}),e.jsxs("div",{style:{fontSize:"clamp(10px, 2vw, 14px)",color:"#ffcccc",marginTop:2},children:["Jouw antwoord: ",a.givenAnswer," | ",new Date(a.timestamp).toLocaleTimeString()]})]},a.id))})]}),T.length>0&&e.jsxs("div",{style:{background:"rgba(255,165,0,0.2)",borderRadius:10,padding:"clamp(8px, 2vw, 15px)",marginTop:"clamp(10px, 2vh, 20px)",maxWidth:"clamp(300px, 80vw, 600px)",width:"100%",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"clamp(12px, 2.5vw, 16px)",color:"#ffa500"},children:["📝 ",T.length," vraag",T.length!==1?"en":""," worden herhaald voor ",s]}),e.jsxs("div",{style:{fontSize:"clamp(10px, 2vw, 14px)",color:"#ffcc99",marginTop:5},children:["Foutieve antwoorden komen terug na elke ",be," vragen"]})]})]}),e.jsxs(Oe,{camera:{position:[0,4.2,12],fov:60},style:{width:"100vw",height:"100vh"},children:[e.jsx($e,{sunPosition:[100,20,100],turbidity:8,distance:450}),e.jsx("ambientLight",{intensity:.7}),e.jsx("directionalLight",{position:[0,20,10],intensity:.7}),e.jsx(Be,{enableZoom:!1,enableRotate:!1}),e.jsx(at,{lanes:o}),e.jsx(De,{lane:E,laneX:ie,lanes:o,invincible:Z}),N.map(a=>e.jsx(nt,{lane:a.lane,laneX:ie,z:a.z,value:a.value,carLane:E},a.id)),J.map(a=>e.jsx(Ne,{lane:a.lane,laneX:ie,z:a.z,colorIndex:a.colorIndex},a.id)),e.jsx(ot,{phase:t,carLane:E,answerBlocks:N,setAnswerBlocks:P,obstacles:J,setObstacles:w,invincible:Z,setInvincible:F,setInvStart:ce,invStart:L,currentQuestion:D,setCurrentQuestion:C,currentCorrect:f,setCurrentCorrect:b,currentRepeatId:y,setCurrentRepeatId:G,updateScore:Ee,setLives:j,lives:z,setPhase:n,setShowGameOver:A,lanes:o,actualCarSpeed:ke,blockStartZ:Ae,gateIntervalMs:Ce,lastGateTime:se,setLastGateTime:oe,bufferActive:ne,setBufferActive:B,speedBoost:m,questionsAnswered:R,setQuestionsAnswered:O,pendingRepeats:T,setPendingRepeats:S,setIncorrectAnswers:k,setRedFlash:I,currentPlayer:s,setGreenFlash:V,setShowCorrectAnswer:Ie,setCorrectAnswerDisplay:Re})]})]})}function st({currentPlayer:t,onBack:n}){const[s,i]=r.useState(Me(t)),o=()=>{confirm(`Weet je zeker dat je alle statistieken voor ${t} wilt wissen?`)&&(tt(t),i({}))},p=(()=>{const h=[];for(let c=1;c<=10;c++)for(let g=1;g<=10;g++){const u=`${c} × ${g}`,z=c*g,j=s[u]||{attempts:0,mistakes:0};h.push({question:u,answer:z,attempts:j.attempts,mistakes:j.mistakes,successRate:j.attempts>0?((j.attempts-j.mistakes)/j.attempts*100).toFixed(1):0})}return h})(),x=p.reduce((h,c)=>h+c.attempts,0),M=p.reduce((h,c)=>h+c.mistakes,0),v=x>0?((x-M)/x*100).toFixed(1):0;return e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.9)",color:"#fff",fontSize:16,padding:"20px",overflowY:"auto",zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:30,flexWrap:"wrap",gap:"20px"},children:[e.jsxs("div",{children:[e.jsxs("h1",{style:{fontSize:36,marginBottom:10,color:"#4CAF50"},children:["📊 Statistieken - ",t]}),e.jsxs("div",{style:{fontSize:18,color:"#ccc"},children:["Totaal: ",x," pogingen | ",M," fouten | ",v,"% correct"]})]}),e.jsxs("div",{style:{display:"flex",gap:"15px"},children:[e.jsx("button",{style:{fontSize:20,padding:"10px 25px",borderRadius:8,border:"2px solid #666",background:"transparent",color:"#fff",fontWeight:600,cursor:"pointer"},onClick:n,children:"← Terug"}),e.jsx("button",{style:{fontSize:20,padding:"10px 25px",borderRadius:8,border:"2px solid #ff4444",background:"transparent",color:"#ff4444",fontWeight:600,cursor:"pointer"},onClick:o,children:"🗑️ Reset"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"2px",background:"#333",padding:"2px",borderRadius:8},children:[e.jsx("div",{style:{background:"#555",padding:"8px",fontWeight:"bold",textAlign:"center",fontSize:14},children:"×"}),[1,2,3,4,5,6,7,8,9,10].map(h=>e.jsx("div",{style:{background:"#555",padding:"8px",fontWeight:"bold",textAlign:"center",fontSize:14},children:h},h)),[1,2,3,4,5,6,7,8,9,10].map(h=>e.jsxs(ye.Fragment,{children:[e.jsx("div",{style:{background:"#555",padding:"8px",fontWeight:"bold",textAlign:"center",fontSize:14},children:h}),[1,2,3,4,5,6,7,8,9,10].map(c=>{const g=`${h} × ${c}`,u=s[g]||{attempts:0,mistakes:0},z=u.attempts>0?(u.attempts-u.mistakes)/u.attempts:1;let j="#222";return u.attempts>0&&(z>=.9?j="#2d5a2d":z>=.7?j="#5a5a2d":z>=.5?j="#5a4a2d":j="#5a2d2d"),e.jsxs("div",{style:{background:j,padding:"8px 4px",textAlign:"center",fontSize:12,lineHeight:1.2,minHeight:"60px",display:"flex",flexDirection:"column",justifyContent:"center"},title:`${g} = ${h*c}
Pogingen: ${u.attempts}
Fouten: ${u.mistakes}
Succes: ${u.attempts>0?(z*100).toFixed(1):0}%`,children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:14},children:h*c}),u.attempts>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:10,color:"#ccc"},children:[u.attempts,"×"]}),u.mistakes>0&&e.jsxs("div",{style:{fontSize:10,color:"#ff6666"},children:[u.mistakes,"✗"]})]})]},c)})]},h))]}),e.jsxs("div",{style:{marginTop:20,padding:15,background:"rgba(255,255,255,0.1)",borderRadius:8,fontSize:14},children:[e.jsx("strong",{children:"Legenda:"}),e.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:8,flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#222",borderRadius:3}}),"Niet geprobeerd"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#2d5a2d",borderRadius:3}}),"90%+ correct"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#5a5a2d",borderRadius:3}}),"70-89% correct"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#5a4a2d",borderRadius:3}}),"50-69% correct"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#5a2d2d",borderRadius:3}}),"<50% correct"]})]})]})]})})}function ot({phase:t,carLane:n,answerBlocks:s,setAnswerBlocks:i,obstacles:o,setObstacles:d,invincible:p,setInvincible:x,setInvStart:M,invStart:v,currentQuestion:h,setCurrentQuestion:c,currentCorrect:g,setCurrentCorrect:u,currentRepeatId:z,setCurrentRepeatId:j,updateScore:D,setLives:C,lives:f,setPhase:b,setShowGameOver:y,lanes:G,actualCarSpeed:R,blockStartZ:O,gateIntervalMs:E,lastGateTime:U,setLastGateTime:N,bufferActive:P,setBufferActive:J,bufferTime:w,speedBoost:Z,questionsAnswered:F,setQuestionsAnswered:L,pendingRepeats:ce,setPendingRepeats:Y,setIncorrectAnswers:te,setRedFlash:K,currentPlayer:A,setGreenFlash:se,setShowCorrectAnswer:oe,setCorrectAnswerDisplay:ne}){return ve(()=>{if(t!=="play")return;const B=Date.now();i(m=>m.map(l=>({...l,z:l.z+R})).filter(l=>l.z<2)),s.forEach(m=>{Math.abs(m.z)<1.2&&m.lane===n&&!p&&(m.value===g?(D(F+1),L(l=>l+1),ge(h,!0,A),se(!0),setTimeout(()=>se(!1),200),z&&(et(z,A),Y(q(A)))):(C(l=>l-1),x(!0),M(B),ge(h,!1,A),K(!0),setTimeout(()=>K(!1),200),ne({question:h,answer:g}),oe(!0),setTimeout(()=>oe(!1),1e3),Ve(h,g,m.value,A),te(ae(A)),z||(Ze(h,g,A),Y(q(A)))),i([]),c(null),u(null),j(null))}),s.length>0&&s.every(m=>m.z>2)&&(c(null),u(null),j(null)),d(m=>m.map(l=>({...l,z:l.z+R})).filter(l=>l.z<2)),o.forEach(m=>{if(Math.abs(m.z)<1.2&&m.lane===n&&!p){const l=s.find(S=>S.lane===n),k=R*2e3/16.67;let T=!1;if(l){const S=Math.abs(l.z);S<=k&&(T=!0,console.log(`Traffic collision protected: gate distance=${S.toFixed(2)}, protection=${k.toFixed(2)}`))}T||(C(S=>S-1),x(!0),M(B),K(!0),setTimeout(()=>K(!1),200)),d(S=>S.filter($=>$.id!==m.id))}}),p&&B-v>Pe&&x(!1),f<=0&&t==="play"&&(b("gameover"),y(!0))}),r.useEffect(()=>{if(t!=="play")return;const B=Math.max(E,100),m=setInterval(()=>{if(s.length===0){const[l,W,k,T]=ze(G,F,q(A));c(l),u(W),j(T);const S=k.map(($,I)=>({lane:I,z:O,value:$,id:Math.random().toString(36).slice(2),questionId:Date.now().toString()}));i(S),N(Date.now()),console.log(`Spawned new gates at z=${O}`)}},B);return()=>clearInterval(m)},[t,G,E,O,s.length,F,A]),r.useEffect(()=>{if(t!=="play")return;const B=Math.max(1,Math.floor(G/2)),m=2500,l=-120,W=setInterval(()=>{d(k=>{if(k.filter(S=>S.z>-150).length<B){const S=s.filter(I=>I.z>-150),$=[];for(let I=0;I<G;I++){let Q=!1;for(const V of S)if(V.lane===I){const X=Math.abs(V.z-l);if(X<Ue){Q=!0,console.log(`Lane ${I} blocked by gate at z=${V.z.toFixed(1)}, distance=${X.toFixed(1)}`);break}}Q||k.find(X=>X.lane===I&&Math.abs(X.z-l)<we*2)&&(Q=!0,console.log(`Lane ${I} blocked by nearby obstacle`)),Q||$.push(I)}if($.length>0){const I=$[Math.floor(Math.random()*$.length)];return console.log(`Spawning traffic car in lane ${I} at z=${l} (${$.length} lanes available)`),[...k,{lane:I,z:l,id:Math.random().toString(36).slice(2),colorIndex:k.length%5}]}else console.log(`No available lanes for traffic spawn (${S.length} active gates)`)}return k})},m);return()=>clearInterval(W)},[t,G,s]),r.useEffect(()=>{if(t!=="play")return;const m=setInterval(()=>{const l=s.filter(W=>W.z>-30&&W.z<10);if(l.length>0&&!P){J(!0);const W=l.reduce((T,S)=>Math.abs(S.z)<Math.abs(T.z)?S:T),k=Math.abs(W.z)/R*16.67;setTimeout(()=>{J(!1)},k+w)}},500);return()=>clearInterval(m)},[s,P,R,w]),null}function at({lanes:t}){return e.jsxs("group",{children:[e.jsxs("mesh",{position:[0,-.4,-90],receiveShadow:!0,children:[e.jsx("boxGeometry",{args:[t*2.5+2,.3,220]}),e.jsx("meshStandardMaterial",{color:Je})]}),Array.from({length:t-1}).map((n,s)=>e.jsxs("mesh",{position:[(s-(t-2)/2)*2.5,-.249,-90],children:[e.jsx("boxGeometry",{args:[.05,.01,220]}),e.jsx("meshStandardMaterial",{color:"#fff"})]},s))]})}function nt({lane:t,laneX:n,z:s,value:i,carLane:o}){const d=s>-2&&s<2&&t===o;return e.jsxs("group",{position:[n(t),.1,s],children:[e.jsxs("mesh",{children:[e.jsx("boxGeometry",{args:[1.08,.63,1.08]}),e.jsx("meshStandardMaterial",{color:"#fff"})]}),!d&&e.jsx(_e,{center:!0,distanceFactor:8,style:Ke,children:i})]})}class je extends ye.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(n,s){console.error("ErrorBoundary caught:",n,s)}render(){return this.state.hasError?e.jsx("h1",{children:"Er is iets misgegaan."}):this.props.children}}const Se=document.getElementById("root");if(Se)he.createRoot(Se).render(e.jsx(je,{children:e.jsx(ue,{})}));else{let t=document.getElementById("root");t||(t=document.createElement("div"),t.id="root",document.body.appendChild(t)),he.createRoot(t).render(e.jsx(je,{children:e.jsx(ue,{})}))}
