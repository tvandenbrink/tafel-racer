import{r,u as be,j as e,C as We,S as Oe,O as Be,R as we,H as _e,c as fe}from"./three-vendor-CsKYoJpk.js";import"./react-vendor-DJG_os-6.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function s(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=s(o);fetch(o.href,c)}})();function De({lane:t,laneX:a,lanes:s,invincible:i}){const o=r.useRef(),[c,d]=r.useState(0),p=r.useRef(new Map).current;r.useEffect(()=>{o.current&&o.current.traverse(w=>{w.isMesh&&w.material&&(p.has(w.uuid)||p.set(w.uuid,w.material.opacity),w.material.transparent=!0)})},[p]),be((w,V)=>{if(o.current)if(i){d(W=>W+V*16);const F=.4+.6*Math.abs(Math.sin(Date.now()/80));o.current.traverse(W=>{W.isMesh&&W.material&&(W.material.opacity=F)}),o.current.rotation.z=.15*Math.sin(c)}else d(0),o.current.traverse(F=>{if(F.isMesh&&F.material){const W=p.get(F.uuid);F.material.opacity=typeof W=="number"?W:1}}),o.current.rotation.z=0});const M="#D32F2F",S="#B71C1C",x="#AABBC3",l="#1A1A1A",u="#B0BEC5",g="#546E7A",z="#FFFDE7",j="#EF5350",$="#78909C",G=.3,f=.95,b=.35,v=2.1,E={color:M,metalness:.4,roughness:.3},I={color:S,metalness:.3,roughness:.4},T={color:x,transparent:!0,opacity:.5,roughness:.1},R={color:l,roughness:.8},N={color:u,metalness:.9,roughness:.25},P={color:g,metalness:.7,roughness:.5},H={color:z,emissive:z,emissiveIntensity:.6},U={color:j,emissive:j,emissiveIntensity:.5};return e.jsxs("group",{ref:o,position:[a(t),G,0],children:[e.jsxs("mesh",{position:[0,.18,.65],children:[e.jsx("boxGeometry",{args:[f*.9,b*.85,v*.4]}),e.jsx("meshStandardMaterial",{...E})]}),e.jsxs("mesh",{position:[0,.2,0],children:[e.jsx("boxGeometry",{args:[f,b,v*.5]}),e.jsx("meshStandardMaterial",{...E})]}),e.jsxs("mesh",{position:[0,.22,-.75],children:[e.jsx("boxGeometry",{args:[f*.95,b*.9,v*.3]}),e.jsx("meshStandardMaterial",{...E})]}),e.jsxs("mesh",{position:[0,b+.02+.175,-.15],children:[" ",e.jsx("boxGeometry",{args:[f*.75,.35,.8]})," ",e.jsx("meshStandardMaterial",{...E})]}),e.jsxs("mesh",{position:[0,b+.25,.2],rotation:[-Math.PI/6.5,0,0],children:[e.jsx("boxGeometry",{args:[f*.7,.02,.45]}),e.jsx("meshStandardMaterial",{...T})]}),e.jsxs("mesh",{position:[0,b+.25,-.48],rotation:[Math.PI/7,0,0],children:[e.jsx("boxGeometry",{args:[f*.65,.02,.35]}),e.jsx("meshStandardMaterial",{...T})]}),e.jsxs("mesh",{position:[-f*.37,b+.2,-.15],rotation:[0,Math.PI/22,0],children:[e.jsx("boxGeometry",{args:[.02,.3,.33]}),e.jsx("meshStandardMaterial",{...T})]}),e.jsxs("mesh",{position:[f*.37,b+.2,-.15],rotation:[0,-Math.PI/22,0],children:[e.jsx("boxGeometry",{args:[.02,.3,.33]}),e.jsx("meshStandardMaterial",{...T})]}),[{x:-f/2+.05,z:v/2*.7,name:"FL"},{x:f/2-.05,z:v/2*.7,name:"FR"},{x:-f/2+.05,z:-v/2*.75,name:"RL"},{x:f/2-.05,z:-v/2*.75,name:"RR"}].map(w=>e.jsxs("group",{position:[w.x,0,w.z],children:[e.jsxs("mesh",{rotation:[0,0,Math.PI/2],children:[e.jsx("cylinderGeometry",{args:[G,G,.18,24]}),e.jsx("meshStandardMaterial",{...R})]}),e.jsxs("mesh",{rotation:[0,0,Math.PI/2],children:[e.jsx("cylinderGeometry",{args:[G*.75,G*.7,.2,20]}),e.jsx("meshStandardMaterial",{...N})]}),e.jsxs("mesh",{rotation:[0,0,Math.PI/2],position:[0,w.name.startsWith("F")?.015:-.015,0],children:[" ",e.jsx("cylinderGeometry",{args:[G*.55,G*.55,.03,16]}),e.jsx("meshStandardMaterial",{...P})]})]},w.name)),e.jsxs("mesh",{position:[0,b+.05,-v/2+.05],children:[e.jsx("boxGeometry",{args:[f*.9,.06,.25]}),e.jsx("meshStandardMaterial",{...I})]}),e.jsxs("mesh",{position:[-.3,b+.02,-v/2+.05],children:[e.jsx("boxGeometry",{args:[.05,.04,.05]}),e.jsx("meshStandardMaterial",{...I})]}),e.jsxs("mesh",{position:[.3,b+.02,-v/2+.05],children:[e.jsx("boxGeometry",{args:[.05,.04,.05]}),e.jsx("meshStandardMaterial",{...I})]}),e.jsxs("mesh",{position:[-f*.3,.2,v/2-.02],rotation:[0,-Math.PI/32,0],children:[e.jsx("boxGeometry",{args:[.15,.1,.04]}),e.jsx("meshStandardMaterial",{...H})]}),e.jsxs("mesh",{position:[f*.3,.2,v/2-.02],rotation:[0,Math.PI/32,0],children:[e.jsx("boxGeometry",{args:[.15,.1,.04]}),e.jsx("meshStandardMaterial",{...H})]}),e.jsxs("mesh",{position:[-f*.3,.25,-v/2+.01],children:[e.jsx("boxGeometry",{args:[.3,.08,.03]}),e.jsx("meshStandardMaterial",{...U})]}),e.jsxs("mesh",{position:[f*.3,.25,-v/2+.01],children:[e.jsx("boxGeometry",{args:[.3,.08,.03]}),e.jsx("meshStandardMaterial",{...U})]}),e.jsxs("mesh",{position:[-f/2-.01,b+.1,.1],children:[e.jsx("boxGeometry",{args:[.03,.08,.12]}),e.jsx("meshStandardMaterial",{...I})]}),e.jsxs("mesh",{position:[f/2+.01,b+.1,.1],children:[e.jsx("boxGeometry",{args:[.03,.08,.12]}),e.jsx("meshStandardMaterial",{...I})]}),e.jsxs("mesh",{position:[-f*.25,.05,-v/2-.01],rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.05,.05,.1,12]}),e.jsx("meshStandardMaterial",{color:$,metalness:.8,roughness:.3})]}),e.jsxs("mesh",{position:[f*.25,.05,-v/2-.01],rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.05,.05,.1,12]}),e.jsx("meshStandardMaterial",{color:$,metalness:.8,roughness:.3})]})]})}function $e({lane:t,laneX:a,z:s,colorIndex:i=0}){const o=["#2c3e50","#e74c3c","#3498db","#27ae60","#f39c12"],c=o[i%o.length],d=c==="#f39c12"?"#e67e22":c;return e.jsxs("group",{position:[a(t),-.4,s],children:[e.jsxs("mesh",{position:[0,.4,0],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.4,.6,2.2]}),e.jsx("meshStandardMaterial",{color:c,metalness:.2,roughness:.6})]}),e.jsxs("mesh",{position:[0,.9,-.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.2,.5,1.4]}),e.jsx("meshStandardMaterial",{color:d,metalness:.1,roughness:.7})]}),e.jsxs("mesh",{position:[0,.25,1.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.3,.3,.2]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[0,.25,-1.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.3,.3,.2]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[.5,.35,1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.25,.15,.1]}),e.jsx("meshStandardMaterial",{color:"#f8f9fa",emissive:"#ffffff",emissiveIntensity:.1})]}),e.jsxs("mesh",{position:[-.5,.35,1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.25,.15,.1]}),e.jsx("meshStandardMaterial",{color:"#f8f9fa",emissive:"#ffffff",emissiveIntensity:.1})]}),e.jsxs("mesh",{position:[.5,.35,-1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.2,.12,.1]}),e.jsx("meshStandardMaterial",{color:"#dc3545",emissive:"#ff0000",emissiveIntensity:.05})]}),e.jsxs("mesh",{position:[-.5,.35,-1.15],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.2,.12,.1]}),e.jsx("meshStandardMaterial",{color:"#dc3545",emissive:"#ff0000",emissiveIntensity:.05})]}),e.jsxs("mesh",{position:[0,.85,.4],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.1,.4,.05]}),e.jsx("meshStandardMaterial",{color:"#17a2b8",transparent:!0,opacity:.6})]}),e.jsxs("mesh",{position:[0,.85,-.8],castShadow:!0,children:[e.jsx("boxGeometry",{args:[1.1,.35,.05]}),e.jsx("meshStandardMaterial",{color:"#17a2b8",transparent:!0,opacity:.6})]}),e.jsxs("mesh",{position:[.75,.75,.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.08,.06,.12]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[-.75,.75,.2],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.08,.06,.12]}),e.jsx("meshStandardMaterial",{color:"#2c3e50"})]}),e.jsxs("mesh",{position:[.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[-.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[-.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.25,.25,.15,8]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a"})]}),e.jsxs("mesh",{position:[.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[-.6,.15,.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[-.6,.15,-.8],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.15,.15,.16,8]}),e.jsx("meshStandardMaterial",{color:"#6c757d"})]}),e.jsxs("mesh",{position:[0,.25,1.32],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.3,.08,.02]}),e.jsx("meshStandardMaterial",{color:"#ffffff"})]}),e.jsxs("mesh",{position:[.4,.08,-1.35],rotation:[0,Math.PI/2,0],castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[.04,.04,.1,8]}),e.jsx("meshStandardMaterial",{color:"#666666",metalness:.8,roughness:.3})]}),e.jsxs("mesh",{position:[.82,.15,0],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.04,.1,2]}),e.jsx("meshStandardMaterial",{color:"#c0392b",metalness:.2,roughness:.5})]}),e.jsxs("mesh",{position:[-.82,.15,0],castShadow:!0,children:[e.jsx("boxGeometry",{args:[.04,.1,2]}),e.jsx("meshStandardMaterial",{color:"#c0392b",metalness:.2,roughness:.5})]})]})}const Ne=2e3,ue=3,ge=-100,Pe=2,He=10,qe="#777",Me=5,Je=2.4,Ue={position:"absolute",top:20,left:20,background:"rgba(0,0,0,0.78)",color:"#fff",fontSize:22,borderRadius:7,padding:"10px 18px",zIndex:10,fontWeight:600},Ye={position:"absolute",top:50,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#000",fontSize:"clamp(24px, 5vw, 48px)",border:"4px solid #ff4141",borderRadius:12,padding:"12px 30px",fontWeight:700,zIndex:10,boxShadow:"0 2px 16px #0002",maxWidth:"90vw",textAlign:"center"},Xe={background:"#fff",color:"#000",fontWeight:700,fontSize:216,borderRadius:8,padding:"6px 18px",border:"2px solid #222",boxShadow:"0 2px 8px #0002",pointerEvents:"none"},de=(t="Floris")=>parseInt(localStorage.getItem(`tafelRaceHighScore_${t}`)||"0"),Ke=(t,a="Floris")=>{localStorage.setItem(`tafelRaceHighScore_${a}`,t.toString())},ae=(t="Floris")=>{const a=localStorage.getItem(`tafelRaceIncorrectAnswers_${t}`);return a?JSON.parse(a):[]},Qe=(t,a,s,i="Floris")=>{const o=ae(i),c={question:t,correctAnswer:a,givenAnswer:s,timestamp:Date.now(),id:Math.random().toString(36).slice(2)};o.unshift(c),o.length>10&&o.splice(10),localStorage.setItem(`tafelRaceIncorrectAnswers_${i}`,JSON.stringify(o))},J=(t="Floris")=>{const a=localStorage.getItem(`tafelRacePendingRepeats_${t}`);return a?JSON.parse(a):[]},Ve=(t,a,s="Floris")=>{const i=J(s),o={question:t,correctAnswer:a,addedAt:Date.now(),id:Math.random().toString(36).slice(2)};i.push(o),localStorage.setItem(`tafelRacePendingRepeats_${s}`,JSON.stringify(i))},Ze=(t,a="Floris")=>{const i=J(a).filter(o=>o.id!==t);localStorage.setItem(`tafelRacePendingRepeats_${a}`,JSON.stringify(i))},ze=(t="Floris")=>{const a=localStorage.getItem(`tafelRaceStatistics_${t}`);return a?JSON.parse(a):{}},je=(t,a,s="Floris")=>{const i=ze(s);i[t]||(i[t]={attempts:0,mistakes:0}),i[t].attempts++,a||i[t].mistakes++,localStorage.setItem(`tafelRaceStatistics_${s}`,JSON.stringify(i))},et=(t="Floris")=>{localStorage.removeItem(`tafelRaceStatistics_${t}`),localStorage.removeItem(`tafelRaceIncorrectAnswers_${t}`),localStorage.removeItem(`tafelRacePendingRepeats_${t}`)};function Ie(t,a=0,s=[]){if(s.length>0&&a>0&&a%Me===0){const p=s[0],M=p.correctAnswer;let S=[M];const x=p.question.split(" × ");if(x.length===2){const l=parseInt(x[0]);for(;S.length<t;){let u=l*(Math.floor(Math.random()*10)+1);S.includes(u)||S.push(u)}}else for(;S.length<t;){let l=Math.floor(Math.random()*100)+1;S.includes(l)||S.push(l)}for(let l=S.length-1;l>0;l--){const u=Math.floor(Math.random()*(l+1));[S[l],S[u]]=[S[u],S[l]]}return[p.question,M,S,p.id]}const i=Math.floor(Math.random()*10)+1,o=Math.floor(Math.random()*10)+1,c=i*o;let d=[c];for(;d.length<t;){let p=i*(Math.floor(Math.random()*10)+1);d.includes(p)||d.push(p)}for(let p=d.length-1;p>0;p--){const M=Math.floor(Math.random()*(p+1));[d[p],d[M]]=[d[M],d[p]]}return[`${i} × ${o}`,c,d,null]}function Se(){const[t,a]=r.useState("init"),[s,i]=r.useState("Floris"),[o,c]=r.useState(()=>window.innerWidth<window.innerHeight?4:6),[d,p]=r.useState(150),[M,S]=r.useState(0),[x,l]=r.useState(0),[u,g]=r.useState(de("Floris")),[z,j]=r.useState(3),[$,G]=r.useState(null),[f,b]=r.useState(null),[v,E]=r.useState(null),[I,T]=r.useState(0),[R,N]=r.useState(0),[P,H]=r.useState([]),[U,w]=r.useState([]),[V,F]=r.useState(!1),[W,pe]=r.useState(0),[Y,ee]=r.useState(ue),[K,k]=r.useState(!1),[te,se]=r.useState(0),[re,oe]=r.useState(!1),[A,h]=r.useState(!1),[m,O]=r.useState(ae("Floris")),[C,L]=r.useState(J("Floris")),[y,X]=r.useState(!1),[B,xe]=r.useState(!1),[Q,_]=r.useState(!1),[ie,ne]=r.useState({question:"",answer:""}),Re=d/1e3*(A?4:1),Ae=ge,ke=M*1e3,he=r.useCallback(()=>{l(0),j(3),N(0),w([]),H([]),k(!1),ee(ue),T(0),a("countdown"),L(J(s))},[s]),Ce=r.useCallback(()=>{a("init"),k(!1)},[]),Ge=r.useCallback(n=>{l(n);const D=de(s);n>D&&(g(n),Ke(n,s))},[s]),le=r.useCallback(n=>{i(n),g(de(n)),O(ae(n)),L(J(n))},[]),Ee=r.useCallback(()=>{a("statistics")},[]);r.useEffect(()=>{if(t!=="countdown")return;if(Y===0){a("play");const[D,q,Z,Te]=Ie(o,I,J(s));G(D),b(q),E(Te),H(Z.map((Le,Fe)=>({lane:Fe,z:ge,value:Le,id:Math.random().toString(36).slice(2),questionId:Date.now().toString()})));return}const n=setTimeout(()=>ee(D=>D-1),1e3);return()=>clearTimeout(n)},[t,Y,o,I,s]),r.useEffect(()=>{if(t!=="play")return;const n=q=>{q.key==="ArrowLeft"&&N(Z=>Math.max(Z-1,0)),q.key==="ArrowRight"&&N(Z=>Math.min(Z+1,o-1)),q.key==="ArrowUp"&&h(!0)},D=q=>{q.key==="ArrowUp"&&h(!1)};return window.addEventListener("keydown",n),window.addEventListener("keyup",D),()=>{window.removeEventListener("keydown",n),window.removeEventListener("keyup",D)}},[t,o]);const ce=n=>(n-(o-1)/2)*2.5,me=r.useCallback(n=>{t==="play"&&N(n)},[t]);return e.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",background:"#7ecbff"},children:[y&&e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(255, 0, 0, 0.6)",zIndex:50,pointerEvents:"none"}}),B&&e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 255, 0, 0.4)",zIndex:50,pointerEvents:"none"}}),Q&&e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.8)",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:60,pointerEvents:"none"},children:[e.jsx("div",{style:{fontSize:60,fontWeight:700,marginBottom:20},children:ie.question}),e.jsxs("div",{style:{fontSize:80,fontWeight:900,color:"#4CAF50"},children:["= ",ie.answer]})]}),e.jsxs("div",{style:{...Ue,fontSize:"clamp(14px, 3vw, 22px)",padding:"8px 16px"},children:["Speler: ",s,"  |  Score: ",x,"  |  Lives: ",z,e.jsx("br",{}),"High Score: ",u]}),t==="play"&&$&&P.length>0&&e.jsx("div",{style:Ye,children:$}),t==="play"&&P.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{position:"absolute",bottom:"clamp(100px, 16vh, 140px)",left:"50%",transform:"translateX(-50%)",background:"rgba(0, 0, 0, 0.8)",color:"#fff",fontSize:"clamp(18px, 4vw, 32px)",fontWeight:"700",padding:"8px 16px",borderRadius:8,zIndex:15,textAlign:"center",border:"2px solid #ff4141"},children:$}),e.jsx("div",{style:{position:"absolute",bottom:"clamp(20px, 4vh, 40px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"clamp(4px, 1vw, 8px)",zIndex:15,padding:"8px",background:"rgba(0, 0, 0, 0.3)",borderRadius:12,backdropFilter:"blur(5px)",maxWidth:"95vw",overflowX:"auto"},children:P.map((n,D)=>e.jsx("button",{onClick:()=>me(n.lane),onTouchStart:q=>{q.preventDefault(),me(n.lane)},style:{width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",borderRadius:"10px",border:R===n.lane?"3px solid #ff4141":"2px solid #fff",background:R===n.lane?"#ff4141":"rgba(255, 255, 255, 0.9)",color:R===n.lane?"#fff":"#000",fontSize:"clamp(14px, 3vw, 20px)",fontWeight:"900",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",userSelect:"none",touchAction:"manipulation",boxShadow:R===n.lane?"0 3px 10px rgba(255, 65, 65, 0.4)":"0 2px 6px rgba(0, 0, 0, 0.2)",transform:R===n.lane?"scale(1.05)":"scale(1)",flexShrink:0},children:n.value},n.id))})]}),t==="play"&&e.jsx("div",{style:{position:"absolute",bottom:"clamp(80px, 12vh, 120px)",right:"clamp(15px, 3vw, 25px)",zIndex:15},children:e.jsxs("button",{onTouchStart:n=>{n.preventDefault(),h(!0)},onTouchEnd:n=>{n.preventDefault(),h(!1)},onMouseDown:()=>h(!0),onMouseUp:()=>h(!1),onMouseLeave:()=>h(!1),style:{width:"clamp(60px, 12vw, 80px)",height:"clamp(60px, 12vw, 80px)",borderRadius:"50%",border:"3px solid #fff",background:A?"linear-gradient(135deg, #ff6b6b, #ee5a52)":"rgba(255, 255, 255, 0.8)",color:A?"#fff":"#000",fontSize:"clamp(12px, 2.5vw, 16px)",fontWeight:"700",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",userSelect:"none",touchAction:"manipulation",boxShadow:A?"0 4px 15px rgba(255, 107, 107, 0.4)":"0 3px 10px rgba(0, 0, 0, 0.2)",transform:A?"scale(1.05)":"scale(1)"},children:[e.jsx("div",{style:{fontSize:"clamp(18px, 4vw, 24px)",marginBottom:"2px"},children:"🚀"}),e.jsx("div",{style:{fontSize:"clamp(8px, 2vw, 12px)"},children:"BOOST"})]})}),t==="countdown"&&e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.6)",color:"#fff",fontSize:90,display:"flex",alignItems:"center",justifyContent:"center",zIndex:20,fontWeight:900},children:Y>0?Y:"GO!"}),K&&e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",color:"#fff",fontSize:48,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:30},children:[e.jsx("div",{style:{marginBottom:30},children:"Game Over"}),e.jsxs("div",{style:{fontSize:32,marginBottom:10},children:["Score: ",x]}),e.jsxs("div",{style:{fontSize:24,marginBottom:30,color:"#ffd700"},children:["High Score: ",u]}),e.jsxs("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{style:{fontSize:28,padding:"12px 40px",borderRadius:10,border:"none",background:"#ff4141",color:"#fff",fontWeight:700,cursor:"pointer",touchAction:"manipulation"},onClick:he,children:"Opnieuw"}),e.jsx("button",{style:{fontSize:28,padding:"12px 40px",borderRadius:10,border:"none",background:"#666",color:"#fff",fontWeight:700,cursor:"pointer",touchAction:"manipulation"},onClick:Ce,children:"Instellingen"})]})]}),t==="statistics"&&e.jsx(tt,{currentPlayer:s,onBack:()=>a("init")}),t==="init"&&e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.7)",color:"#fff",fontSize:"clamp(20px, 4vw, 32px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",zIndex:40,padding:"clamp(10px, 3vw, 20px)",overflowY:"auto"},children:[e.jsx("div",{style:{marginBottom:"clamp(20px, 5vh, 40px)",fontSize:"clamp(24px, 6vw, 40px)"},children:"Tafel Race Game"}),e.jsxs("div",{style:{fontSize:"clamp(18px, 4vw, 28px)",marginBottom:"clamp(15px, 4vh, 30px)",textAlign:"center"},children:[e.jsx("div",{style:{marginBottom:15},children:"Kies speler:"}),e.jsxs("div",{style:{display:"flex",gap:"clamp(10px, 3vw, 20px)",justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(8px, 2vw, 12px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"3px solid #ff4141",background:s==="Floris"?"#ff4141":"transparent",color:"#fff",fontWeight:700,cursor:"pointer",transition:"all 0.2s ease",touchAction:"manipulation"},onClick:()=>le("Floris"),children:"👦 Floris"}),e.jsx("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(8px, 2vw, 12px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"3px solid #ff4141",background:s==="Esmee"?"#ff4141":"transparent",color:"#fff",fontWeight:700,cursor:"pointer",transition:"all 0.2s ease",touchAction:"manipulation"},onClick:()=>le("Esmee"),children:"👧 Esmee"}),e.jsx("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(8px, 2vw, 12px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"3px solid #ff4141",background:s==="Tim"?"#ff4141":"transparent",color:"#fff",fontWeight:700,cursor:"pointer",transition:"all 0.2s ease",touchAction:"manipulation"},onClick:()=>le("Tim"),children:"👨‍🦳 Tim"})]})]}),e.jsxs("div",{style:{fontSize:"clamp(14px, 3vw, 22px)",marginBottom:"clamp(10px, 2vh, 20px)",textAlign:"center"},children:["Aantal rijstroken: ",o,e.jsx("input",{type:"range",min:Pe,max:He,value:o,onChange:n=>c(+n.target.value),style:{marginLeft:12,width:"clamp(100px, 25vw, 150px)"}})]}),e.jsxs("div",{style:{fontSize:"clamp(14px, 3vw, 22px)",marginBottom:"clamp(10px, 2vh, 20px)",textAlign:"center"},children:["Snelheid: ",d,e.jsx("input",{type:"range",min:20,max:200,value:d,onChange:n=>p(+n.target.value),style:{marginLeft:12,width:"clamp(100px, 25vw, 150px)"}})]}),e.jsxs("div",{style:{fontSize:"clamp(14px, 3vw, 22px)",marginBottom:"clamp(15px, 3vh, 30px)",textAlign:"center"},children:["Poorten interval: ",M,"s",e.jsx("input",{type:"range",min:2,max:8,value:M,onChange:n=>S(+n.target.value),style:{marginLeft:12,width:"clamp(100px, 25vw, 150px)"}})]}),e.jsxs("button",{style:{fontSize:"clamp(18px, 4vw, 28px)",padding:"clamp(8px, 2vh, 12px) clamp(20px, 5vw, 40px)",borderRadius:10,border:"none",background:"#ff4141",color:"#fff",fontWeight:700,cursor:"pointer",marginBottom:"clamp(10px, 2vh, 20px)",touchAction:"manipulation"},onClick:he,children:["Start (",s,")"]}),e.jsxs("button",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",padding:"clamp(6px, 1.5vh, 10px) clamp(15px, 4vw, 30px)",borderRadius:10,border:"2px solid #4CAF50",background:"transparent",color:"#4CAF50",fontWeight:700,cursor:"pointer",marginBottom:"clamp(20px, 4vh, 40px)",touchAction:"manipulation"},onClick:Ee,children:["📊 Statistieken (",s,")"]}),e.jsxs("div",{style:{fontSize:"clamp(16px, 3.5vw, 24px)",marginBottom:"clamp(15px, 3vh, 30px)",color:"#ffd700",textAlign:"center"},children:["🏆 ",s,"'s High Score: ",u]}),m.length>0&&e.jsxs("div",{style:{background:"rgba(255,255,255,0.1)",borderRadius:10,padding:"clamp(10px, 3vw, 20px)",maxWidth:"clamp(300px, 80vw, 600px)",width:"100%"},children:[e.jsxs("h3",{style:{fontSize:"clamp(14px, 3vw, 20px)",marginBottom:15,color:"#ff6b6b",textAlign:"center"},children:[s,"'s Fouten (Laatste 10)"]}),e.jsx("div",{style:{maxHeight:"clamp(200px, 30vh, 300px)",overflowY:"auto",fontSize:"clamp(12px, 2.5vw, 16px)"},children:m.map((n,D)=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",margin:"5px 0",padding:"8px",borderRadius:5,borderLeft:"3px solid #ff6b6b"},children:[e.jsxs("div",{style:{fontWeight:"bold"},children:[n.question," = ",n.correctAnswer]}),e.jsxs("div",{style:{fontSize:"clamp(10px, 2vw, 14px)",color:"#ffcccc",marginTop:2},children:["Jouw antwoord: ",n.givenAnswer," | ",new Date(n.timestamp).toLocaleTimeString()]})]},n.id))})]}),C.length>0&&e.jsxs("div",{style:{background:"rgba(255,165,0,0.2)",borderRadius:10,padding:"clamp(8px, 2vw, 15px)",marginTop:"clamp(10px, 2vh, 20px)",maxWidth:"clamp(300px, 80vw, 600px)",width:"100%",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"clamp(12px, 2.5vw, 16px)",color:"#ffa500"},children:["📝 ",C.length," vraag",C.length!==1?"en":""," worden herhaald voor ",s]}),e.jsxs("div",{style:{fontSize:"clamp(10px, 2vw, 14px)",color:"#ffcc99",marginTop:5},children:["Foutieve antwoorden komen terug na elke ",Me," vragen"]})]})]}),e.jsxs(We,{camera:{position:[0,4.2,12],fov:60},style:{width:"100vw",height:"100vh"},children:[e.jsx(Oe,{sunPosition:[100,20,100],turbidity:8,distance:450}),e.jsx("ambientLight",{intensity:.7}),e.jsx("directionalLight",{position:[0,20,10],intensity:.7}),e.jsx(Be,{enableZoom:!1,enableRotate:!1}),e.jsx(ot,{lanes:o}),e.jsx(De,{lane:R,laneX:ce,lanes:o,invincible:V}),P.map(n=>e.jsx(nt,{lane:n.lane,laneX:ce,z:n.z,value:n.value,carLane:R},n.id)),U.map(n=>e.jsx($e,{lane:n.lane,laneX:ce,z:n.z,colorIndex:n.colorIndex},n.id)),e.jsx(st,{phase:t,carLane:R,answerBlocks:P,setAnswerBlocks:H,obstacles:U,setObstacles:w,invincible:V,setInvincible:F,setInvStart:pe,invStart:W,currentQuestion:$,setCurrentQuestion:G,currentCorrect:f,setCurrentCorrect:b,currentRepeatId:v,setCurrentRepeatId:E,updateScore:Ge,setLives:j,lives:z,setPhase:a,setShowGameOver:k,lanes:o,actualCarSpeed:Re,blockStartZ:Ae,gateIntervalMs:ke,lastGateTime:te,setLastGateTime:se,bufferActive:re,setBufferActive:oe,speedBoost:A,questionsAnswered:I,setQuestionsAnswered:T,pendingRepeats:C,setPendingRepeats:L,setIncorrectAnswers:O,setRedFlash:X,currentPlayer:s,setGreenFlash:xe,setShowCorrectAnswer:_,setCorrectAnswerDisplay:ne})]})]})}function tt({currentPlayer:t,onBack:a}){const[s,i]=r.useState(ze(t)),o=()=>{confirm(`Weet je zeker dat je alle statistieken voor ${t} wilt wissen?`)&&(et(t),i({}))},d=(()=>{const x=[];for(let l=1;l<=10;l++)for(let u=1;u<=10;u++){const g=`${l} × ${u}`,z=l*u,j=s[g]||{attempts:0,mistakes:0};x.push({question:g,answer:z,attempts:j.attempts,mistakes:j.mistakes,successRate:j.attempts>0?((j.attempts-j.mistakes)/j.attempts*100).toFixed(1):0})}return x})(),p=d.reduce((x,l)=>x+l.attempts,0),M=d.reduce((x,l)=>x+l.mistakes,0),S=p>0?((p-M)/p*100).toFixed(1):0;return e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.9)",color:"#fff",fontSize:16,padding:"20px",overflowY:"auto",zIndex:40},children:e.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:30,flexWrap:"wrap",gap:"20px"},children:[e.jsxs("div",{children:[e.jsxs("h1",{style:{fontSize:36,marginBottom:10,color:"#4CAF50"},children:["📊 Statistieken - ",t]}),e.jsxs("div",{style:{fontSize:18,color:"#ccc"},children:["Totaal: ",p," pogingen | ",M," fouten | ",S,"% correct"]})]}),e.jsxs("div",{style:{display:"flex",gap:"15px"},children:[e.jsx("button",{style:{fontSize:20,padding:"10px 25px",borderRadius:8,border:"2px solid #666",background:"transparent",color:"#fff",fontWeight:600,cursor:"pointer"},onClick:a,children:"← Terug"}),e.jsx("button",{style:{fontSize:20,padding:"10px 25px",borderRadius:8,border:"2px solid #ff4444",background:"transparent",color:"#ff4444",fontWeight:600,cursor:"pointer"},onClick:o,children:"🗑️ Reset"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))",gap:"2px",background:"#333",padding:"2px",borderRadius:8},children:[e.jsx("div",{style:{background:"#555",padding:"8px",fontWeight:"bold",textAlign:"center",fontSize:14},children:"×"}),[1,2,3,4,5,6,7,8,9,10].map(x=>e.jsx("div",{style:{background:"#555",padding:"8px",fontWeight:"bold",textAlign:"center",fontSize:14},children:x},x)),[1,2,3,4,5,6,7,8,9,10].map(x=>e.jsxs(we.Fragment,{children:[e.jsx("div",{style:{background:"#555",padding:"8px",fontWeight:"bold",textAlign:"center",fontSize:14},children:x}),[1,2,3,4,5,6,7,8,9,10].map(l=>{const u=`${x} × ${l}`,g=s[u]||{attempts:0,mistakes:0},z=g.attempts>0?(g.attempts-g.mistakes)/g.attempts:1;let j="#222";return g.attempts>0&&(z>=.9?j="#2d5a2d":z>=.7?j="#5a5a2d":z>=.5?j="#5a4a2d":j="#5a2d2d"),e.jsxs("div",{style:{background:j,padding:"8px 4px",textAlign:"center",fontSize:12,lineHeight:1.2,minHeight:"60px",display:"flex",flexDirection:"column",justifyContent:"center"},title:`${u} = ${x*l}
Pogingen: ${g.attempts}
Fouten: ${g.mistakes}
Succes: ${g.attempts>0?(z*100).toFixed(1):0}%`,children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:14},children:x*l}),g.attempts>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:10,color:"#ccc"},children:[g.attempts,"×"]}),g.mistakes>0&&e.jsxs("div",{style:{fontSize:10,color:"#ff6666"},children:[g.mistakes,"✗"]})]})]},l)})]},x))]}),e.jsxs("div",{style:{marginTop:20,padding:15,background:"rgba(255,255,255,0.1)",borderRadius:8,fontSize:14},children:[e.jsx("strong",{children:"Legenda:"}),e.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:8,flexWrap:"wrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#222",borderRadius:3}}),"Niet geprobeerd"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#2d5a2d",borderRadius:3}}),"90%+ correct"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#5a5a2d",borderRadius:3}}),"70-89% correct"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#5a4a2d",borderRadius:3}}),"50-69% correct"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("div",{style:{width:20,height:20,background:"#5a2d2d",borderRadius:3}}),"<50% correct"]})]})]})]})})}function st({phase:t,carLane:a,answerBlocks:s,setAnswerBlocks:i,obstacles:o,setObstacles:c,invincible:d,setInvincible:p,setInvStart:M,invStart:S,currentQuestion:x,setCurrentQuestion:l,currentCorrect:u,setCurrentCorrect:g,currentRepeatId:z,setCurrentRepeatId:j,updateScore:$,setLives:G,lives:f,setPhase:b,setShowGameOver:v,lanes:E,actualCarSpeed:I,blockStartZ:T,gateIntervalMs:R,lastGateTime:N,setLastGateTime:P,bufferActive:H,setBufferActive:U,bufferTime:w,speedBoost:V,questionsAnswered:F,setQuestionsAnswered:W,pendingRepeats:pe,setPendingRepeats:Y,setIncorrectAnswers:ee,setRedFlash:K,currentPlayer:k,setGreenFlash:te,setShowCorrectAnswer:se,setCorrectAnswerDisplay:re}){const oe=r.useRef(0);return be(()=>{if(t!=="play")return;const A=Date.now();i(h=>h.map(m=>({...m,z:m.z+I})).filter(m=>m.z<2)),s.forEach(h=>{Math.abs(h.z)<1.2&&h.lane===a&&!d&&(h.value===u?($(F+1),W(m=>m+1),je(x,!0,k),te(!0),setTimeout(()=>te(!1),200),z&&(Ze(z,k),Y(J(k)))):(G(m=>m-1),p(!0),M(A),je(x,!1,k),K(!0),setTimeout(()=>K(!1),200),re({question:x,answer:u}),se(!0),setTimeout(()=>se(!1),1e3),Qe(x,u,h.value,k),ee(ae(k)),z||(Ve(x,u,k),Y(J(k)))),i([]),l(null),g(null),j(null))}),s.length>0&&s.every(h=>h.z>2)&&(l(null),g(null),j(null)),c(h=>h.map(m=>({...m,z:m.z+I})).filter(m=>m.z<2)),o.forEach(h=>{if(Math.abs(h.z)<1.2&&h.lane===a&&!d){const m=s.find(y=>y.lane===a),C=I*2e3/16.67;let L=!1;if(m){const y=Math.abs(m.z);y<=C&&(L=!0,console.log(`Traffic collision protected: gate distance=${y.toFixed(2)}, protection=${C.toFixed(2)}`))}L||(G(y=>y-1),p(!0),M(A),K(!0),setTimeout(()=>K(!1),200)),c(y=>y.filter(X=>X.id!==h.id))}}),d&&A-S>Ne&&p(!1),f<=0&&t==="play"&&(b("gameover"),v(!0))}),r.useEffect(()=>{if(t!=="play")return;const A=Math.max(R,100),h=setInterval(()=>{if(s.length===0){const[m,O,C,L]=Ie(E,F,J(k));l(m),g(O),j(L);const y=C.map((X,B)=>({lane:B,z:T,value:X,id:Math.random().toString(36).slice(2),questionId:Date.now().toString()}));i(y),P(Date.now()),console.log(`Spawned new gates at z=${T}`)}},A);return()=>clearInterval(h)},[t,E,R,T,s.length,F,k]),r.useEffect(()=>{if(t!=="play")return;const A=Math.max(1,Math.floor(E/2)),h=2500,m=T,O=2e3,C=2e3,L=setInterval(()=>{const y=Date.now();if(y-oe.current<O||y-N<C)return;const X=Math.max(R,100);s.length===0&&X<C||c(B=>{if(B.filter(_=>_.z>m-50).length>=A)return B;const Q=[];for(let _=0;_<E;_++)B.some(ne=>ne.lane===_&&Math.abs(ne.z-m)<Je*3)||Q.push(_);if(Q.length>0){const _=Q[Math.floor(Math.random()*Q.length)];return oe.current=y,[...B,{lane:_,z:m,id:Math.random().toString(36).slice(2),colorIndex:B.length%5}]}return B})},h);return()=>clearInterval(L)},[t,E,T,R,N,s.length]),r.useEffect(()=>{if(t!=="play")return;const h=setInterval(()=>{const m=s.filter(O=>O.z>-30&&O.z<10);if(m.length>0&&!H){U(!0);const O=m.reduce((L,y)=>Math.abs(y.z)<Math.abs(L.z)?y:L),C=Math.abs(O.z)/I*16.67;setTimeout(()=>{U(!1)},C+w)}},500);return()=>clearInterval(h)},[s,H,I,w]),null}function ot({lanes:t}){return e.jsxs("group",{children:[e.jsxs("mesh",{position:[0,-.4,-90],receiveShadow:!0,children:[e.jsx("boxGeometry",{args:[t*2.5+2,.3,220]}),e.jsx("meshStandardMaterial",{color:qe})]}),Array.from({length:t-1}).map((a,s)=>e.jsxs("mesh",{position:[(s-(t-2)/2)*2.5,-.249,-90],children:[e.jsx("boxGeometry",{args:[.05,.01,220]}),e.jsx("meshStandardMaterial",{color:"#fff"})]},s))]})}function nt({lane:t,laneX:a,z:s,value:i,carLane:o}){const c=s>-2&&s<2&&t===o;return e.jsxs("group",{position:[a(t),.1,s],children:[e.jsxs("mesh",{children:[e.jsx("boxGeometry",{args:[1.08,.63,1.08]}),e.jsx("meshStandardMaterial",{color:"#fff"})]}),!c&&e.jsx(_e,{center:!0,distanceFactor:8,style:Xe,children:i})]})}class ve extends we.Component{constructor(a){super(a),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s)}render(){return this.state.hasError?e.jsx("h1",{children:"Er is iets misgegaan."}):this.props.children}}const ye=document.getElementById("root");if(ye)fe.createRoot(ye).render(e.jsx(ve,{children:e.jsx(Se,{})}));else{let t=document.getElementById("root");t||(t=document.createElement("div"),t.id="root",document.body.appendChild(t)),fe.createRoot(t).render(e.jsx(ve,{children:e.jsx(Se,{})}))}
